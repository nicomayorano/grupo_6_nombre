<!DOCTYPE html>
<html lang="es">
<head>
  <%- include('../partials/head')%>
  <link rel="stylesheet" href="/css/product-form.css"/>
  <script type="text/javascript" src="/js/product-form.js"></script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
</head>
<body>
  <%- include('../partials/header')%>
  <main>
    <div class="submit-main-wrapper">
      <section class="submit-main-section">
        <h2 class="submit-main-header-text">
          Editar tu propiedad
        </h2>
        <form action="/products/<%= property.id %>" method="POST" enctype="multipart/form-data" class="submit-form">
          <div class="submit-form-main-data-wrapper">
            <select name="type" class="submit-form-input" id="select-type"> 
              <option disabled>Tipo de propiedad</option>
              <option value="flat" <%= property.type === 'flat' ? 'selected' : ''%>>Departamento</option>
              <option value="house" <%= property.type === 'house' ? 'selected' : ''%>>Casa</option>
              <option value="cabin" <%= property.type === 'cabin' ? 'selected' : ''%>>Cabaña</option>
              <option value="country" <%= property.type === 'country' ? 'selected' : ''%>>Quinta</option>
              <option value="hotel" <%= property.type === 'hotel' ? 'selected' : ''%>>Hotel</option>
              <option value="room" <%= property.type === 'room' ? 'selected' : ''%>>Habitación</option>
              <option value="hostel" <%= property.type === 'hostel' ? 'selected' : ''%>>Hostel</option>
            </select>
            <div class="form-price-guests-wrapper">
              <label for="max_guests" class="submit-form-label">Huéspedes</label>
              <label for="price" class="submit-form-label">Precio por noche</label>
              <input type="number" name="max_guests" id="max_guests" min="1" max="15" size="2" class="submit-form-input" value="<%= property.max_guests%>">              
              <input type="number" name="price" id="price" min="1" max="9999999" class="submit-form-input" value="<%= property.price%>">
            </div>     
          </div>
          <div class="submit-form-description-wrapper">
            <h4 class="wrapper-header">Descripción</h4>
            <textarea name="description" id="description" rows="4" class="submit-form-input" onload="getTextareaValue()"></textarea>
          </div>
          <div class="submit-form-amenities-wrapper">
            <h4 class="wrapper-header">Amenidades</h4>
            <span class="amenitie-wrapper">
              <input type="checkbox" name="wifi" id="wifi" <%= property.wifi ? 'checked' : '' %>>
              <label for="wifi" class="amenitie-label">WiFi</label>
            </span>
            <span class="amenitie-wrapper">
              <input type="checkbox" name="room_service" id="room_service" <%= property.room_service ? 'checked' : '' %>>
              <label for="room_service" class="amenitie-label">Servicio de limpieza</label>
            </span>
            <span class="amenitie-wrapper">
              <input type="checkbox" name="breakfast" id="breakfast" <%= property.breakfast ? 'checked' : '' %>>
              <label for="breakfast" class="amenitie-label">Desayuno</label>
            </span>
            <span class="amenitie-wrapper">
              <input type="checkbox" name="pets" id="pets" <%= property.pets ? 'checked' : '' %>>
              <label for="pets" class="amenitie-label">Mascotas</label>
            </span>
            <span class="amenitie-wrapper">
              <input type="checkbox" name="garage" id="garage" <%= property.garage ? 'checked' : '' %>>
              <label for="garage" class="amenitie-label">Garage</label>
            </span>
            <span class="amenitie-wrapper">
              <input type="checkbox" name="linens" id="linens" <%= property.linens ? 'checked' : '' %>>
              <label for="linens" class="amenitie-label">Ropa de cama</label>
            </span>
            <span class="amenitie-wrapper">
              <input type="checkbox" name="heating" id="heating" <%= property.heating ? 'checked' : '' %>>
              <label for="heating" class="amenitie-label">Calefacción</label>
            </span>
            <span class="amenitie-wrapper">
              <input type="checkbox" name="air_conditioning" id="air_conditioning" <%= property.air_conditioning ? 'checked' : '' %>>
              <label for="air_conditioning" class="amenitie-label">Aire acondicionado</label>  
            </span>
            <span class="amenitie-wrapper">
              <input type="checkbox" name="pool" id="pool" <%= property.pool ? 'checked' : '' %>>
              <label for="pool" class="amenitie-label">Piscina</label>  
            </span>
            <span class="amenitie-wrapper">
              <input type="checkbox" name="grill" id="grill" <%= property.grill ? 'checked' : '' %>>
              <label for="grill" class="amenitie-label">Parrilla</label>  
            </span>
          </div>
          <div class="submit-form-location-wrapper">
            <h4 class="wrapper-header">Ubicación</h4>
            <select name="province" id="province" oninput="enableCityField()" class="submit-form-input location-input">
              <option disabled>Provincia</option>
                <% let provinces = ['Buenos Aires', 'Ciudad Autónoma de Buenos Aires', 'Catamarca', 'Chaco', 'Chubut', 'Córdoba', 'Corrientes', 'Entre Ríos', 'Formosa',' Jujuy', 'La Pampa', 'La Rioja', 'Mendoza', 'Misiones', 'Neuquén', 'Rio Negro', 'Salta',' San Juan', 'San Luis', 'Santa Cruz', 'Santa Fe', 'Santiago del Estero', 'Tierra del Fuego', 'Tucumán']; %>
                <% for(let i = 0; i < provinces.length; i++ ) { %>
                <option value="<%= provinces[i] %>" <%= property.province === provinces[i] ? 'selected' : '' %>><%= provinces[i] %></option>
                <% } %>
            </select>
            <input list="city-datalist" oninput="fetchCities()" id="city" placeholder="Ciudad" disabled class="submit-form-input location-input" value="<%= property.city %>">
            <datalist name="city" id="city-datalist">
            </datalist>
            <input type="text" name="address" placeholder="Dirección" id="address" onchange="codeAddress()" class="submit-form-input location-input" value="<%= property.address %>">
            <div id="map"></div>
          </div>
          <div class="submit-form-images-wrapper">
            <h4 class="wrapper-header">Imágenes</h4>
            <input type="file" name="images" id="images" multiple onchange="previewImages()" class="submit-form-input" accept=".png, .jpg, .bmp, .webp">
            <div class="images-ul-text">
              <ul>
                <li>Hasta 6 imágenes.</li>
                <li>Dimensión sugerida: 1024x768 píxeles</li>
                <li>Formatos soportados: .png .jpg .bmp .webp</li>
              </ul>
            </div>            
            <div id="submit-preview-images"></div>
          </div>
          <div class="submit-form-buttons-wrapper">
            <button type="submit" id="submit-form-save-button">Guardar</button>  
            <button type="reset" id="submit-form-reset-button">Limpiar</button>
          </div>
        </form>
      </section>
    </div>
  </main>
  <%- include('../partials/footer')%>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAU2gdFktGQ_U01Y1Rx4inx6sqxvolG4Oc&callback=initMap&v=weekly" defer></script>
</body>
</html>